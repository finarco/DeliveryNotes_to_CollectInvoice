{# Sidebar Component #}
<aside class="sidebar">
  <div class="sidebar-top">
    {# Logo Section #}
    <div class="sidebar-logo">
      <div class="logo-icon">D</div>
      <div class="logo-text">DeliveryNotes</div>
    </div>

    {# Tenant Switcher #}
    {% if current_tenant %}
    <div class="tenant-switcher" style="padding: 0.5rem 1rem; margin-bottom: 0.5rem;">
      {% if user_tenants and user_tenants|length > 1 %}
      <form method="post" action="{{ url_for('tenant.switch_tenant') }}" style="margin: 0;">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <select name="tenant_id" onchange="this.form.submit()"
                style="width: 100%; padding: 0.35rem 0.5rem; border-radius: 6px; border: 1px solid var(--border-color, #ddd); font-size: 0.85rem; background: var(--bg-secondary, #f8f9fa);">
          {% for ut in user_tenants %}
          <option value="{{ ut.tenant_id }}" {% if ut.tenant_id == current_tenant.id %}selected{% endif %}>
            {{ ut.tenant.name }}
          </option>
          {% endfor %}
        </select>
      </form>
      {% else %}
      <div style="font-size: 0.8rem; color: var(--text-secondary, #666); padding: 0.25rem 0;">
        {{ current_tenant.name }}
      </div>
      {% endif %}
    </div>
    {% endif %}

    {# Navigation #}
    <nav>
      <ul class="sidebar-nav">
        <li class="sidebar-nav-item">
          <a href="{{ url_for('dashboard.index') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="7" height="7"></rect>
              <rect x="14" y="3" width="7" height="7"></rect>
              <rect x="14" y="14" width="7" height="7"></rect>
              <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            <span>Prehľad</span>
          </a>
        </li>

        {% if "manage_all" in user_permissions or "manage_partners" in user_permissions %}
        <li class="sidebar-nav-item">
          <a href="{{ url_for('partners.list_partners') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <span>Partneri</span>
          </a>
        </li>
        {% endif %}

        {% if "manage_all" in user_permissions or "manage_orders" in user_permissions %}
        <li class="sidebar-nav-item">
          <a href="{{ url_for('orders.list_orders') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            <span>Objednávky</span>
          </a>
        </li>

        <li class="sidebar-nav-item">
          <a href="{{ url_for('products.list_products') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
              <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
              <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
            <span>Produkty</span>
          </a>
        </li>

        <li class="sidebar-nav-item">
          <a href="{{ url_for('products.list_bundles') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
              <polyline points="2 17 12 22 22 17"></polyline>
              <polyline points="2 12 12 17 22 12"></polyline>
            </svg>
            <span>Kombinácie</span>
          </a>
        </li>
        {% endif %}

        {% if "manage_all" in user_permissions or "manage_delivery" in user_permissions %}
        <li class="sidebar-nav-item">
          <a href="{{ url_for('delivery.list_delivery_notes') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="1" y="3" width="15" height="13"></rect>
              <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
              <circle cx="5.5" cy="18.5" r="2.5"></circle>
              <circle cx="18.5" cy="18.5" r="2.5"></circle>
            </svg>
            <span>Dodacie listy</span>
          </a>
        </li>
        {% endif %}

        {% if "manage_all" in user_permissions or "manage_invoices" in user_permissions %}
        <li class="sidebar-nav-item">
          <a href="{{ url_for('invoices.list_invoices') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1z"></path>
              <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path>
              <path d="M12 17.5v.5"></path>
              <path d="M12 6v.5"></path>
            </svg>
            <span>Faktúry</span>
          </a>
        </li>
        {% endif %}

        {% if "manage_all" in user_permissions %}
        <li class="sidebar-nav-item">
          <a href="{{ url_for('db_tools.index') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
              <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
              <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
            </svg>
            <span>DB Tools</span>
          </a>
        </li>

        <li class="sidebar-nav-item">
          <a href="{{ url_for('admin.users') }}" class="sidebar-nav-link">
            <svg class="sidebar-nav-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
            <span>Administrácia</span>
          </a>
        </li>
        {% endif %}
      </ul>
    </nav>
  </div>

  {# Bottom Section #}
  <div class="sidebar-bottom">
    {# Upgrade Box #}
    <div class="upgrade-box">
      <div class="upgrade-box-title">UPGRADE NA PRO</div>
      <div class="upgrade-box-text">Získajte rozšírené funkcie, reporty a exporty pre váš biznis.</div>
      <button type="button" class="btn btn-sm">Začať trial</button>
    </div>

    {# Account Widget #}
    <div class="account-widget">
      <div class="account-avatar">
        {{ current_user.username[0].upper() if current_user else 'U' }}
      </div>
      <div class="account-info">
        <div class="account-name">{{ current_user.username if current_user else 'User' }}</div>
        <div class="account-role">Administrator</div>
      </div>
      <button type="button" class="logout-button" title="Odhlásiť">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
      </button>
    </div>
  </div>
</aside>

{# Hidden logout form #}
<form id="logout-form" action="{{ url_for('auth.logout') }}" method="post" style="display: none;">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
</form>
